%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: doc.dvi
%%Pages: 7
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Palatino-Roman Palatino-Italic Helvetica Helvetica-Bold
%%+ Palatino-Bold Symbol Courier Palatino-BoldItalic EURM10
%%DocumentPaperSizes: a4
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips doc.dvi
%DVIPSParameters: dpi=1200, compressed
%DVIPSSource:  TeX output 2001.02.26:1647
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "1 July 1998",
%   filename = "8r.enc",
%   email = "tex-fonts@@tug.org",
%   docstring = "Encoding for TrueType or Type 1 fonts
%                to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both 
% ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 1200 1200 (doc.dvi)
@start
%DVIPSBitmapFont: Fa cmmi10 9.37793 2
/Fa 2 63 df<1D70F401F8F407FC1C1F1C7F983801FFF8090713F0093F13C098B5120008
0313FC080F13F0083F13C097B5C7FC070313FC070F13E0073F1380DFFFFEC8FC060313F8
060F13E0063F1380DEFFFEC9FC050713F8051F13E0057F13804C4848CAFC040713F8041F
13E0047F1380922601FFFCCBFC030713F0031F13C0037F90CCFC913801FFFC020713F002
1F13C091B5CDFC010313FC010F13F0013F13C090B5CEFC000313FC000F13F0003F138048
48CFFCEAFFF813E013F8EA7FFE6C6C7E000F13F0000313FCC613FF013F13C0010F13F001
0313FC010013FF021F13C0020713F0020113FC6E6CB4FC031F13C0030713F0030113FC6F
6CB47E041F13E0040713F8040113FE706C6C7E051F13E0050713F8050013FE95383FFF80
060F13E0060313F8060013FE96383FFF80070F13E0070313FC070013FF083F13C0080F13
F0080313FC080013FF093F13C0090713F0090113F89838007FFC1C1F1C07F401F8F40070
5E5B73D379>60 D<1238127EB47E13E013F8EA7FFE6C6C7E000F13F0000313FCC613FF01
3F13C0010F13F0010313FC010013FF021F13C0020713F0020113FC6E6CB4FC031F13C003
0713F0030113FC6F6CB47E041F13E0040713F8040113FE706C6C7E051F13E0050713F805
0013FE95383FFF80060F13E0060313F8060013FE96383FFF80070F13E0070313FC070013
FF083F13C0080F13F0080313FC080013FF093F13C0090713F0090113F89838007FFC1C1F
1C7F983801FFF8090713F0093F13C098B51200080313FC080F13F0083F13C097B5C7FC07
0313FC070F13E0073F1380DFFFFEC8FC060313F8060F13E0063F1380DEFFFEC9FC050713
F8051F13E0057F13804C4848CAFC040713F8041F13E0047F1380922601FFFCCBFC030713
F0031F13C0037F90CCFC913801FFFC020713F0021F13C091B5CDFC010313FC010F13F001
3F13C090B5CEFC000313FC000F13F0003F13804848CFFCEAFFF813E01380007ED0FC1238
5E5B73D379>62 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fc cmsy10 6.25195 1
/Fc 1 95 df<153CA2157EA215FFA34A7FA24A7F15E702077F15C3A2020F7F1581021F7F
15004A7F023E137CA2027E137E027C133E02FC133F4A7FA20101814A130F0103814A1307
0107814A1303A2010F814A1301011F8191C8FC4981013E157CA2017E157E017C153E01FC
153F49810001178049150FA2000317C0491507000717E0491503000F17F0491501A2001F
17F890CAFC4817FC003E177C007E177E007C173EA200FC173F48171FA20070170E38417A
BE45>94 D E
%EndDVIPSBitmapFont
/Fd 135[120 7[133 9[80 102[{TeXBase1Encoding ReEncodeFont}3
239.103 /Palatino-BoldItalic rf /Fe 140[85 85 1[85 7[85
1[85 85 1[85 33[85 17[85 47[{
.85 ExtendFont TeXBase1Encoding ReEncodeFont}9 166.044
/Courier rf /Fg 133[120 1[120 199 1[146 80 106 93 1[146
133 146 213 80 2[80 146 133 93 120 146 106 1[120 12[159
1[173 1[146 199 5[93 2[133 3[159 186 12[120 120 120 120
3[80 45[{TeXBase1Encoding ReEncodeFont}33 239.103 /Palatino-Bold
rf /Fh 138[101 2[65 5[55 2[55 1[92 1[83 2[101 83 12[111
13[92 11[42 6[83 83 83 49[{TeXBase1Encoding ReEncodeFont}14
166.044 /Palatino-Bold rf
%DVIPSBitmapFont: Fi cmsy10 9.37793 4
/Fi 4 107 df<153E157F4B7EA86FC9FCA400081708003E173ED87F8016FF486C4B1380
6D5D01F8150F6D5D6C6C4B1300273FFF803EEBFFFE6C01C0495B000701F0010713F0C601
F8491380D93FFC4948C7FCD90FFFEB7FF801039038BEFFE0010090B51280023F49C8FC02
0F13F8020313E002001380020313E0020F13F8023F13FE91B67E010301BE13E0010F9038
3E7FF8D93FFCEB1FFED9FFF86D6C7E000701F06D13F0001F01C0010113FC4801806D7F27
7FFE007FEB3FFF48486F1380498101E0150349816C486F1300003EC7153E00081708C892
C7FCA44B7EA86FC9FC153E394376C74E>3 D<1E3F8BA48B1E1FA38B1E0F8BA21E078B1E
038B1E018B787EA2797E797EA2797E797E8C797E797E797E797FF87FE07A7E7A7EF80FFE
7A7E7A13C0003FC212F04821FEC41280A36CF9FE006C21F0D3000313C05690C7FC565AF8
1FF8565A565AF8FF805590C8FC555A555A555A68555A555AA2555A55C9FCA2545A671E03
671E07671E0FA2671E1F67A31E3F67A49CCAFC895177CE9C>33 D<1C7E1CFF88891C3F89
1C1F891C0F89767E1C0389767E1C0089777E777E777EA2777E777E777E777E003FBFFC48
8AC012E08B8B6C8A6C1EFFD100017F7813E0F73FF0F71FFC79B4FC0D0313C07913F09C38
007FFC7AB47E0E0F13E00E0313FC0E00EBFF80213F9EB5FC0E03EBFC000E0F13E00E3F13
80E67FFCC7FC9C3801FFF05513C00D0F90C8FCF71FFCF73FF0F7FFE0541380003FC0C9FC
481EFCC05A67676C1E806C9BCAFCD0EA01FE535A535A535A535AA2535A535A53CBFC651C
01525A651C07525A651C1F651C3F651C7F9ACCFC641C7E895777D19C>41
D<1238127C12FEB3B3B3B3B3B3B3B3A8127C1238079C6EF42B>106
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fj cmr10 9.37793 1
/Fj 1 62 df<003FBE12F0481DF8BF12FCA36C1DF86C1DF0D2FCB3A7003FBE12F0481DF8
BF12FCA36C1DF86C1DF0662777B979>61 D E
%EndDVIPSBitmapFont
/Fl 134[83 83 116 83 91 50 83 58 1[91 91 91 1[42 2[42
91 91 50 83 91 83 1[83 14[108 2[116 10[108 68[{
TeXBase1Encoding ReEncodeFont}23 149.44 /Helvetica-Bold
rf /Fm 107[50 26[75 75 108 75 83 42 75 50 1[83 83 83
124 33 75 1[33 83 83 42 83 83 75 83 83 3[42 1[42 2[100
141 100 108 91 100 108 1[100 116 108 124 83 2[42 108
116 91 100 108 108 100 100 6[42 1[83 83 83 83 2[83 1[83
1[42 1[42 2[50 50 33 36[75 2[{TeXBase1Encoding ReEncodeFont}60
149.44 /Helvetica rf /Fn 171[81 6[126 81 3[111 72[{
TeXBase1Encoding ReEncodeFont}4 132.835 /Palatino-Roman
rf /Fo 133[74 1[83 2[92 55 65 65 1[83 74 92 1[46 74 1[46
83 1[46 65 83 68 1[74 51[55 42[88 2[{TeXBase1Encoding ReEncodeFont}20
166.044 /Palatino-Italic rf /Fp 105[83 27[83 92 86 138
94 100 54 70 66 93 100 91 97 147 48 92 1[48 97 92 55
80 101 74 92 83 3[55 1[55 2[111 166 1[129 102 87 111
2[131 138 157 101 1[55 56 138 1[92 101 129 118 1[129
5[42 42 83 83 83 83 83 83 83 83 83 83 101 42 55 42 4[46
35[101 100 2[{TeXBase1Encoding ReEncodeFont}65 166.044
/Palatino-Roman rf /Fq 135[103 166 1[120 65 84 79 1[120
109 116 176 58 2[58 116 111 66 95 122 88 1[100 12[122
105 2[120 1[166 9[154 141 1[155 6[50 1[100 5[100 1[100
1[50 6[55 39[{TeXBase1Encoding ReEncodeFont}32 199.253
/Palatino-Roman rf /Fr 135[143 7[143 9[80 102[{
TeXBase1Encoding ReEncodeFont}3 286.924 /Palatino-Italic
rf /Fs 139[94 122 113 1[172 157 167 253 83 2[83 167 160
96 137 1[127 1[143 12[176 3[173 6[97 7[223 25[80 39[{
TeXBase1Encoding ReEncodeFont}20 286.924 /Palatino-Roman
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 1200dpi
TeXDict begin
%%BeginPaperSize: a4
a4
%%EndPaperSize

%%EndSetup
%%Page: 1 1
1 0 bop 1314 1760 a Fs(The)72 b Fr(fxp)p Fs('s)f(Application)k(Pr)-5
b(ogramming)73 b(Interface)3624 2744 y Fq(August)50 b(2000)1561
3310 y(Note:)61 b(The)50 b(following)f(is)g(an)g(excerpt)h(fr)l(om)f
(the)h(Chapter)e(2)h(Section)h(8)1312 3528 y(of)g(the)g(Andr)l(eas)g
(Neumann's)g(Ph.D.)g(Thesis.)1561 3926 y Fp(The)d Fo(fxp)p
Fp('s)h(application)g(interface)f(is)h(a)g(functional)g(variant)f(of)h
(an)g(event-based)f(in-)1312 4126 y(terface)60 b(that)h(vitally)h(r)m
(elies)f(on)k(S)8 b Fn(M)g(L)t Fp('s)62 b(parametrized)e(modules)h(for)
g(customization.)1312 4325 y(Its)52 b(information)e(set)h(includes)h
(all)g(r)m(equir)m(ed)f(and)g(most)g(optional)g(information)f(items)
1312 4524 y(of)41 b(the)k(X)8 b Fn(M)g(L)46 b Fp(information)40
b(set)i([1].)1561 4723 y(The)34 b(application)h(de\002nes)g(a)g(data)h
(type)e Fm(AppData)h Fp(r)m(epr)m(esenting)e(the)h(part)h(of)g(its)h
(state)1312 4923 y(af)m(fected)61 b(by)g(the)f(event)g(handlers.)109
b(W)-15 b(e)61 b(call)g(this)h(information)e(the)g Fo(application)h
(data)p Fp(.)1312 5122 y(During)40 b(parsing,)g(a)h(value)g(of)f(this)i
(type)e(is)i(maintained)e(by)h(the)f(parser)-12 b(.)49
b(Upon)40 b(trigger)m(-)1312 5321 y(ing)50 b(an)h(event,)f(the)g(event)
f(handler)h(r)m(eceives)f(the)h(application)g(data)h(as)g(an)f
(additional)1312 5520 y(parameter)60 b(and)i(r)m(eturns)f(it)i(\226)f
(possibly)h(modi\002ed)g(\226)f(to)g(the)g(parser)-12
b(.)112 b(The)61 b(modi\002ed)1312 5720 y(application)48
b(data)h(is)h(then)d(an)h(ar)m(gument)g(to)g(the)g(next)g(event,)g(and)
h(so)g(forth.)71 b(In)48 b(or)m(der)1312 5919 y(to)g(distinguish)i
(this)e(kind)h(of)f(event)f(handlers)h(fr)m(om)f(the)g(imperative)g
(variant)h(we)g(call)1312 6118 y(them)34 b Fo(hooks)p
Fp(.)48 b(The)34 b(ef)m(fects)h(of)h(all)g(hooks)f(ar)m(e)f(thus)i
(accumulated)f(into)g(one)f(value)h(of)g(type)1312 6317
y Fm(AppData)o Fp(.)1561 6517 y(In)50 b(or)m(der)g(to)g(implement)f
(hooks)i(in)f Fo(fxp)p Fp(,)j(the)d(parser)f(must)i(be)f(pr)m(ovided)h
(with)g(the)1312 6716 y(type)j(of)g(the)f(application)h(data)h(and)f
(with)g(the)g(functions)g(implementing)f(the)g(hooks.)1312
6915 y(The)68 b(easiest)h(way)h(of)f(doing)g(so)g(is)h(to)f(pack)g
(them)e(into)i(a)g(str)o(uctur)m(e)f Fm(Hooks)p Fp(,)75
b(ful\002ll-)1312 7114 y(ing)54 b(the)g(signatur)m(e)g(in)h(Figur)m(e)
108 b(1.)90 b(The)53 b(purposes)h(of)g(the)g(single)g(hooks)g(ar)m(e)g
(listed)h(in)1312 7314 y(T)-15 b(able1.)61 b(A)45 b(hook)f(expects)g
(as)h(ar)m(gument)f(the)h(curr)m(ent)e(application)i(data)h(and)f(\226)
g(except)1312 7513 y(for)55 b Fm(hookFinish)i Fp(\226)e(the)h
(information)e(belonging)i(to)g(the)f(signaled)i(event,)g(and)f(r)m
(eturns)1312 7712 y(the)41 b(modi\002ed)h(application)f(data.)1561
7911 y(The)52 b(data)j(types)e(pr)m(oviding)h(the)f(event-speci\002c)f
(information)h(passed)h(to)f(a)h(hook)1312 8111 y(ar)m(e)44
b(de\002ned)i(by)g(str)o(uctur)m(e)e Fm(HookData)p Fp(.)63
b(Each)45 b(information)g(item)g(contains)g(at)h(least)g(the)1312
8310 y(position)d(in)h(the)f(document)g(wher)m(e)f(the)h(event)g
(occurr)m(ed;)g(for)g(some)g(events)g(even)f(two)1312
8509 y(positions)g(ar)m(e)g(speci\002ed:)53 b(a)42 b(start)h(position)f
(and)g(an)g(end)g(position.)54 b(E.g.,)41 b(type)h Fm(ErrorInf)l(o)1312
8708 y Fp(describes)52 b(an)h(err)m(or)e(by)i(means)f(of)g(its)i
(position)f(and)g(an)f(err)m(or)f(description.)85 b(A)53
b(start-)1312 8908 y(tag)48 b(is)g(described)g(by)f(the)g(positions)h
(of)g(its)g(\002rst)h(and)e(last)i(character)-12 b(,)46
b(the)h(index)g(of)h(the)1312 9107 y(element,)62 b(the)d(list)i(of)f
(attribute)g(speci\002cations)g(the)f(eventual)g(spaces)h(following)h
(the)1312 9306 y(element)53 b(name)h(and)h(a)g(boolean)f(\003ag,)59
b(indicating)c(whether)f(it)i(is)g(an)e(empty-element)1312
9505 y(tag:)1727 9767 y Fl(type)42 b Fm(ErrorInf)l(o)58
b Fj(=)h Fm(Errors)n(.P)-7 b(osition)58 b Fi(\003)h Fm(Errors)n(.Error)
1727 9950 y Fl(type)42 b Fm(Star)6 b(tT)-18 b(agInf)l(o)58
b Fj(=)h Fm(Star)6 b(tEnd)59 b Fi(\003)h Fm(int)f Fi(\003)h
Fm(AttSpecList)e Fi(\003)i Fm(UniChar)-7 b(.Data)58 b
Fi(\003)i Fm(bool)1561 10228 y Fp(The)48 b(information)g(set)h(pr)m
(ovided)g(thr)m(ough)f Fo(fxp)p Fp('s)i(hooks)f(is)h(suf)m(\002cient)g
(for)f(pr)m(oduc-)1312 10428 y(ing)54 b(a)g(character)m(-by-character)c
(identical)55 b(copy)e(of)h(the)f(document)g(instance.)87
b(Except)1312 10627 y(for)35 b(white)g(space)g(and)h(parameter)d
(entity)j(r)m(efer)m(ences)d(within)j(declarations,)g(this)g(is)g(also)
1312 10826 y(possible)42 b(for)f(the)f(DTD.)4134 11324
y(1)p eop
%%Page: 2 2
2 1 bop 465 903 5729 7 v 465 6282 7 5379 v 598 1164 a
Fl(signature)42 b Fm(Hooks)60 b Fj(=)812 1347 y Fl(sig)1027
1529 y(type)41 b Fm(AppData)1027 1712 y Fl(type)g Fm(AppFinal)1027
1973 y Fl(v)m(al)g Fm(hookError)356 b(:)51 b(AppData)60
b Fi(\003)f Fm(HookData.ErrorInf)l(o)373 b Fi(!)59 b
Fm(AppData)1027 2155 y Fl(v)m(al)41 b Fm(hookW)-6 b(ar)t(ning)135
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.W)-6 b(ar)t(ningInf)l(o)152
b Fi(!)59 b Fm(AppData)1027 2416 y Fl(v)m(al)41 b Fm(hookStar)6
b(tT)-18 b(ag)127 b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.Star)6
b(tT)-18 b(agInf)l(o)144 b Fi(!)59 b Fm(AppData)1027
2599 y Fl(v)m(al)41 b Fm(hookEndT)-18 b(ag)184 b(:)51
b(AppData)60 b Fi(\003)f Fm(HookData.EndT)-18 b(agInf)l(o)201
b Fi(!)59 b Fm(AppData)1027 2860 y Fl(v)m(al)41 b Fm(hookData)373
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.DataInf)l(o)390
b Fi(!)59 b Fm(AppData)1027 3042 y Fl(v)m(al)41 b Fm(hookCData)265
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.CDataInf)l(o)282
b Fi(!)59 b Fm(AppData)1027 3225 y Fl(v)m(al)41 b Fm(hookCharRef)132
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.CharRefInf)l(o)149
b Fi(!)59 b Fm(AppData)1027 3486 y Fl(v)m(al)41 b Fm(hookProcInst)139
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.ProcInstInf)l(o)156
b Fi(!)59 b Fm(AppData)1027 3668 y Fl(v)m(al)41 b Fm(hookComment)h(:)51
b(AppData)60 b Fi(\003)f Fm(HookData.CommentInf)l(o)g
Fi(!)g Fm(AppData)1027 3851 y Fl(v)m(al)41 b Fm(hookWhite)307
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.WhiteInf)l(o)324
b Fi(!)59 b Fm(AppData)1027 4034 y Fl(v)m(al)41 b Fm(hookDecl)390
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.DeclInf)l(o)407
b Fi(!)59 b Fm(AppData)1027 4294 y Fl(v)m(al)41 b Fm(hookDocT)-18
b(ype)109 b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.DtdInf)l(o)473
b Fi(!)59 b Fm(AppData)1027 4477 y Fl(v)m(al)41 b Fm(hookSubset)223
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.SubsetInf)l(o)240
b Fi(!)59 b Fm(AppData)1027 4660 y Fl(v)m(al)41 b Fm(hookExtSubset)8
b(:)49 b(AppData)60 b Fi(\003)f Fm(HookData.ExtSubsetInf)l(o)27
b Fi(!)55 b Fm(AppData)1027 4842 y Fl(v)m(al)41 b Fm(hookEndDtd)190
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.EndDtdInf)l(o)207
b Fi(!)59 b Fm(AppData)1027 5103 y Fl(v)m(al)41 b Fm(hookGenRef)174
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.GenRefInf)l(o)191
b Fi(!)59 b Fm(AppData)1027 5286 y Fl(v)m(al)41 b Fm(hookP)-6
b(arRef)229 b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.P)-6
b(arRefInf)l(o)246 b Fi(!)59 b Fm(AppData)1027 5469 y
Fl(v)m(al)41 b Fm(hookEntEnd)198 b(:)51 b(AppData)60
b Fi(\003)f Fm(HookData.EntEndInf)l(o)215 b Fi(!)59 b
Fm(AppData)1027 5729 y Fl(v)m(al)41 b Fm(hookXml)432
b(:)51 b(AppData)60 b Fi(\003)f Fm(HookData.XmlInf)l(o)449
b Fi(!)59 b Fm(AppData)1027 5912 y Fl(v)m(al)41 b Fm(hookFinish)291
b(:)51 b(AppData)1856 b Fi(!)59 b Fm(AppFinal)812 6095
y Fl(end)p 6187 6282 V 465 6289 5729 7 v 2199 6493 a
Fh(Figure)42 b(1:)f Fp(The)g Fm(Hooks)g Fp(signatur)m(e.)p
465 6580 V 714 6912 a(In)47 b(addition)i(to)f(type)f
Fm(AppData)p Fp(,)i(a)e Fm(Hooks)h Fp(str)o(uctur)m(e)e(must)j
(de\002ne)e(a)h(type)f Fm(AppFinal)q Fp(.)465 7111 y(This)35
b(type)f(is)h(the)f(r)m(esult)h(type)f(of)h(the)f(parser:)46
b(At)35 b(the)f(end)g(of)g(the)g(document,)h(the)f(parser)465
7310 y(calls)f Fm(hookFinish)g Fp(in)f(or)m(der)f(to)i
Fo(\002nalize)e Fp(the)h(accumulated)g(application)g(data.)49
b(This)32 b(is)h(use-)465 7509 y(ful)45 b(because)f(values)h(of)g(type)
f Fm(AppData)g Fp(often)g(contain)g(auxiliary)h(information:)56
b(E.g.,)45 b(if)465 7709 y(an)56 b(application)h(collects)f
(information)f(fr)m(om)h(the)g(document)g(entity,)j(it)f(must)e(ignor)m
(e)465 7908 y(all)41 b(events)f(occurring)f(within)j(entity)e(r)m
(eplacement)f(texts.)50 b(For)40 b(this)i(r)m(eason,)d(the)h(hooks)465
8107 y(might)52 b(maintain)g(a)g(counter)f(indicating)i(the)f(nesting)g
(depth)f(of)i(included)f(entity)h(r)m(ef-)465 8306 y(er)m(ences.)k
Fm(hookFinish)45 b Fp(then)e(r)m(emoves)f(this)j(counter)d(because)i
(it)g(is)h(of)f(no)g(inter)m(est)f(to)h(the)465 8506
y(application.)78 b(Another)49 b(example)g(for)h(the)g(bene\002ts)g(of)
h(\002nalization)g(is)g(the)f(following:)465 8705 y(An)55
b(application)h(might)f(collect)h(section)f(titles)h(in)g(or)m(der)e
(to)i(compile)e(a)i(table)g(of)f(con-)465 8904 y(tents.)61
b(Since)44 b(the)h(application)f(data)i(is)g(an)e(accumulating)h
(parameter,)e(these)i(titles)g(ar)m(e)465 9103 y(collected)k(in)g(r)m
(everse)f(or)m(der)-12 b(.)74 b Fm(AppFinal)50 b Fp(can)f(be)g(used)h
(for)f(r)m(eestablishing)g(the)g(original)465 9303 y(or)m(der)-12
b(.)465 9874 y Fg(1)239 b(Functorizing)58 b(the)h(Parser)465
10252 y Fp(The)h(parser)g(is)i(ther)m(efor)m(e)d(implemented)h(as)h(an)
k(S)8 b Fn(M)g(L)66 b Fo(functor)p Fp(,)g(expecting)59
b(the)i Fm(Hooks)465 10452 y Fp(str)o(uctur)m(e)47 b(as)i(ar)m(gument.)
70 b(The)47 b(application)h(can)g(then)f(generate)g(several)g
(instances)h(of)465 10651 y(the)g(parser)g(for)g(dif)m(fer)m(ent)g
(purposes.)72 b(In)49 b(addition)g(to)g(the)f(hooks,)i(the)e(parser)f
(functor)3288 11324 y(2)p eop
%%Page: 3 3
3 2 bop 1320 903 5713 7 v 1317 1103 7 200 v 2587 1103
V 7026 1103 V 1317 1146 V 1452 1086 a Fp(Hook)p 2587
1146 V 863 w(X)8 b Fn(M)g(L)46 b Fp(Event)p 7026 1146
V 1320 1153 5713 7 v 1317 1352 7 200 v 2587 1352 V 7026
1352 V 1320 1193 5713 7 v 1317 1392 7 200 v 2587 1392
V 7026 1392 V 1317 1435 V 1452 1376 a Fm(hookError)p
2587 1435 V 614 w Fp(err)m(or)p 7026 1435 V 1317 1635
V 1452 1575 a Fm(hookW)-6 b(ar)t(ning)p 2587 1635 V 393
w Fp(warning)p 7026 1635 V 1320 1641 5713 7 v 1317 1840
7 200 v 2587 1840 V 7026 1840 V 1317 1884 V 1452 1824
a Fm(hookStar)6 b(tT)-18 b(ag)p 2587 1884 V 385 w Fp(start-tag)p
7026 1884 V 1317 2083 V 1452 2023 a Fm(hookEndT)g(ag)p
2587 2083 V 442 w Fp(end-tag)p 7026 2083 V 1320 2090
5713 7 v 1317 2289 7 200 v 2587 2289 V 7026 2289 V 1317
2333 V 1452 2273 a Fm(hookData)p 2587 2333 V 631 w Fp(segment)41
b(of)g(character)f(data)p 7026 2333 V 1317 2532 V 1452
2472 a Fm(hookCData)p 2587 2532 V 523 w Fp(CDA)-12 b(T)g(A)40
b(section)p 7026 2532 V 1317 2731 V 1452 2671 a Fm(hookCharRef)p
2587 2731 V 390 w Fp(character)g(r)m(efer)m(ence)p 7026
2731 V 1320 2738 5713 7 v 1317 2937 7 200 v 2587 2937
V 7026 2937 V 1317 2980 V 1452 2921 a Fm(hookProcInst)p
2587 2980 V 397 w Fp(pr)m(ocessing)h(instr)o(uction)p
7026 2980 V 1317 3180 V 1452 3120 a Fm(hookComment)p
2587 3180 V 300 w Fp(comment)p 7026 3180 V 1317 3379
V 1452 3319 a Fm(hookDecl)p 2587 3379 V 648 w Fp(element,)e(attribute,)
i(notation)g(or)g(entity)g(declaration)p 7026 3379 V
1320 3386 5713 7 v 1317 3585 7 200 v 2587 3585 V 7026
3585 V 1317 3628 V 1452 3569 a Fm(hookDocT)-18 b(ype)p
2587 3628 V 367 w Fp(start)42 b(of)f(the)g(DTD)p 7026
3628 V 1317 3828 V 1452 3768 a Fm(hookSubset)p 2587 3828
V 481 w Fp(start)h(of)f(the)g(internal)g(subset)p 7026
3828 V 1317 4027 V 1452 3967 a Fm(hookExtSubset)p 2587
4027 V 264 w Fp(start)h(of)f(the)g(external)f(subset)p
7026 4027 V 1317 4226 V 1452 4166 a Fm(hookEndDtd)p 2587
4226 V 448 w Fp(end)h(of)h(the)f(DTD)p 7026 4226 V 1320
4233 5713 7 v 1317 4432 7 200 v 2587 4432 V 7026 4432
V 1317 4476 V 1452 4416 a Fm(hookGenRef)p 2587 4476 V
432 w Fp(general)g(entity)g(r)m(efer)m(ence)p 7026 4476
V 1317 4675 V 1452 4615 a Fm(hookP)-6 b(arRef)p 2587
4675 V 487 w Fp(parameter)40 b(entity)h(r)m(efer)m(ence)p
7026 4675 V 1317 4874 V 1452 4814 a Fm(hookEntEnd)p 2587
4874 V 456 w Fp(end)g(of)h(an)f(included)h(entity)p 7026
4874 V 1320 4881 5713 7 v 1317 5080 7 200 v 2587 5080
V 7026 5080 V 1317 5123 V 1452 5064 a Fm(hookXml)p 2587
5123 V 690 w Fp(start)g(of)f(the)g(document)g(entity)p
7026 5123 V 1317 5323 V 1452 5263 a Fm(hookFinish)p 2587
5323 V 549 w Fp(end)g(of)h(the)f(document)p 7026 5323
V 1320 5329 5713 7 v 2531 5534 a Fh(T)-18 b(able)41 b(1:)g
Fp(The)g(hooks)g(in)g Fo(fxp)h Fp(and)g(their)f(purposes.)p
1312 5621 5729 7 v 1312 5827 V 1312 7554 7 1727 v 1445
6087 a Fl(funsig)g Fm(P)-6 b(arse)41 b(\()h Fl(structure)g
Fm(Dtd)344 b(:)51 b(Dtd)2452 6270 y Fl(structure)42 b
Fm(Hooks)153 b(:)51 b(Hooks)2452 6453 y Fl(structure)42
b Fm(Resolv)l(e)f(:)51 b(Resolv)l(e)2452 6635 y Fl(structure)42
b Fm(Options)62 b(:)51 b(Options)42 b(\))60 b Fj(=)1659
6818 y Fl(sig)1874 7001 y(v)m(al)41 b Fm(parseDocument)g(:)51
b(Ur)r(i.Ur)r(i)41 b(option)60 b Fi(!)g Fm(Dtd.Dtd)40
b(option)3328 7183 y Fi(!)59 b Fm(Hooks)n(.AppData)f
Fi(!)i Fm(Hooks)n(.AppFinal)1659 7366 y Fl(end)p 7034
7554 V 1312 7561 5729 7 v 3122 7764 a Fh(Figure)42 b(2:)f
Fp(The)g Fm(P)-6 b(arser)40 b Fp(functor)-12 b(.)p 1312
7848 V 1312 8180 a(is)42 b(parametrized)e(with)i(thr)m(ee)e(other)g
(str)o(uctur)m(es:)1312 8512 y Fl(Options)p Fh(:)83 b
Fp(This)38 b(str)o(uctur)m(e)f(supplies)i(the)e(parser)g(with)i(its)g
(options.)49 b(It)39 b(is)f(useful)h(to)f(have)1727 8712
y(each)61 b(instance)g(of)g(the)g(parser)g(r)o(un)g(with)h(its)h(own)e
(set)h(of)g(options:)91 b(E.g.,)70 b(X)8 b Fn(M)g(L)1727
8911 y Fp(catalogs)52 b(fr)m(equently)f(have)f(no)h(DTD.)80
b(Ther)m(efor)m(e)49 b(a)i(catalog)h(is)g(parsed)g(in)f(non-)1727
9110 y(validating)43 b(mode,)d(even)g(if)i(the)f(main)g(document)f(is)j
(validated.)1312 9442 y Fl(Resolve)p Fh(:)82 b Fp(This)68
b(str)o(uctur)m(e)f(pr)m(ovides)g(a)g(single)h(function)f(for)g(r)m
(esolving)h(an)f(external)1727 9641 y(identi\002er)41
b(to)h(a)f(URI:)2092 9957 y Fl(v)m(al)g Fm(resolv)l(eExtId)f(:)51
b(Base)n(.Exter)t(nalId)58 b Fi(!)h Fm(Ur)r(i.Ur)r(i)1727
10289 y Fp(In)38 b(the)g(simplest)i(case)e(this)h(function)g(r)m
(eturns)e(the)i(system)g(identi\002er)g(that)f(is)i(part)1727
10488 y(of)50 b(the)g(external)e(identi\002er)-12 b(.)77
b(If)51 b(the)e(parser)h(supports)k(X)8 b Fn(M)g(L)54
b Fp(catalogs,)f(however)-12 b(,)1727 10688 y(this)42
b(is)g(the)f(function)g(that)g(sear)m(ches)g(the)g(catalog.)4134
11324 y(3)p eop
%%Page: 4 4
4 3 bop 465 1063 a Fl(Dtd)p Fh(:)82 b Fp(The)57 b(implementation)f(of)i
(the)f(DTD)f(tables)i(can)f(be)g(pr)m(ovided)g(by)h(the)f(applica-)880
1262 y(tion.)50 b(In)38 b(most)h(cases)f(this)i(is)f(the)f
Fm(Dtd)g Fp(str)o(uctur)m(e)g(pr)m(ovided)g(by)h Fo(fxp)p
Fp(,)g(but)g(the)f(appli-)880 1461 y(cation)49 b(can)f(also)h(pr)m
(ovide)f(a)h(mor)m(e)f(ef)m(\002cient)h(implementation,)f(or)g(enhance)
f(the)880 1660 y(functionality)d(of)f(the)g(DTD)f(tables.)56
b(For)43 b(instance,)g(the)f(operations)g(on)h(the)g(DTD)880
1860 y(tables)f(might)g(be)g(wrapped)g(into)f(functions)h(pr)m(oducing)
g(debugging)h(or)e(statisti-)880 2059 y(cal)c(information.)49
b(On)36 b(the)g(other)g(hand,)h(the)g(application)g(can)f
Fo(hard-code)g Fp(element)880 2258 y(types)i(or)g(attributes)g(to)g
(\002xed)h(indices.)50 b(E.g.,)38 b(in)g(or)m(der)g(to)g(collect)f
Fe(href)g Fp(attributes)880 2457 y(in)44 b(an)k(X)8 b
Fn(H)g(T)g(M)g(L)48 b Fp(document,)c(one)e(might)j(use)f(the)f
(following)i(implementation)d(of)880 2657 y(the)f Fm(Dtd)g
Fp(ar)m(gument)f(str)o(uctur)m(e:)1245 2972 y Fl(structure)j
Fm(HrefDtd)58 b Fj(=)1460 3155 y Fl(struct)1674 3337
y(open)43 b Fm(Dtd)1674 3598 y Fl(v)m(al)f Fm(hrefData)59
b Fj(=)g Fm(UniChar)-7 b(.Str)r(ing2Data)40 b(\224href\224)1674
3859 y Fl(fun)i Fm(initDtdT)-18 b(ab)m(les)42 b(\(\))59
b Fj(=)1889 4042 y Fl(let)41 b(v)m(al)g Fm(dtd)60 b Fj(=)f
Fm(Dtd.initDtdT)-18 b(ab)m(les\(\))2105 4224 y Fl(v)m(al)p
2351 4248 79 6 v 179 w Fj(=)60 b Fm(AttNot2Inde)l(x)39
b(dtd)i(hrefData)1889 4407 y Fl(in)g Fm(dtd)1889 4590
y Fl(end)1674 4850 y(v)m(al)h Fm(hrefIdx)59 b Fj(=)g
Fm(AttNot2Inde)l(x)39 b(\(initDtdT)-18 b(ab)m(les\(\)\))41
b(hrefData)1460 5033 y Fl(end)880 5365 y Fp(A)i Fe(href)f
Fp(attribute)h(will)i(then)d(always)i(have)f(index)f
Fm(hrefIdx)o Fp(;)i(sear)m(ching)e(and)h(com-)880 5564
y(paring)75 b(can)g(be)g(done)f(with)i(this)g(constant)f(rather)f(than)
h(the)f(list)j(of)e(charac-)880 5764 y(ters)46 b Fm
([0wx68,0wx72,0wx65,)f(0wx66])p Fp(.)65 b(This)46 b(is)h(r)m(easonable)
e(also)i(because)e(element)880 5963 y(types)k(ar)m(e)f(passed)i(to)f
(the)f(hooks)h(by)g(means)f(of)h(their)f(indices)h(in)g(the)g(DTD,)e
(not)880 6162 y(by)42 b(their)e(names.)465 6494 y(The)63
b(signatur)m(e)i(of)f(the)g(parser)f(functor)g(is)i(given)f(in)h(Figur)
m(e)f(2.)120 b(It)64 b(de\002nes)h(a)f(single)465 6694
y(function)57 b Fm(parseDocument)f Fp(which,)61 b(given)c(an)f
(optional)h(URI)g(of)g(a)h(document)e(and)h(an)465 6893
y(optional)39 b(DTD,)f(parses)i(that)g(document)e(\226)i(if)h(no)e(URI)
h(is)g(given,)f(the)h(document)e(is)j(r)m(ead)465 7092
y(fr)m(om)48 b(the)g(standar)m(d)i(input.)73 b(It)49
b(r)m(eturns)f(the)g(\002nalized)i(value)e(of)h(the)f(application)h
(data)465 7291 y(r)m(eceived)40 b(in)h(its)i(thir)m(d)e(ar)m(gument,)f
(modi\002ed)i(by)g(the)f(hooks)g(during)h(parsing.)714
7491 y(If)33 b(the)g(optional)f Fm(Dtd)h Fp(ar)m(gument)f(is)i(given)e
(as)i Fm(NONE)o Fp(,)h(the)d(parser)g(initializes)i(the)f(DTD)465
7690 y(tables)51 b(with)g(the)g Fm(initDtdT)-18 b(ab)m(les)50
b Fp(function.)79 b(In)50 b(this)i(case)e(hooks)h(have)f(no)g(access)h
(to)f(the)465 7889 y(DTD)34 b(because)h(it)h(is)g(not)g(pr)m(ovided)f
(as)h(an)f(ar)m(gument)g(to)g(them.)48 b(For)35 b(many)g(applications)
465 8088 y(this)46 b(is)g(not)f(necessary)f(indeed.)62
b(If)46 b(the)f(hooks)g(need)f(to)h(access)g(the)g(DTD,)f(the)g
(applica-)465 8288 y(tion)f(must)i(initialize)f(the)f(tables)h(itself,)
h(incorporate)d(them)h(into)g(the)g(application)h(data)465
8487 y(and)e(pass)g(them)e(to)h(the)g(parser)g(in)g(its)h
Fm(Dtd)f Fp(ar)m(gument.)465 9058 y Fg(2)239 b(Building)59
b(Applications)f(with)i Fd(fxp)465 9437 y Fo(fxp)46 b
Fp(pr)m(ovides)f(a)g(rich)g(information)f(set)i(thr)m(ough)e(its)j
(hooks)e(interface.)62 b(Many)45 b(applica-)465 9636
y(tions,)c(however)-12 b(,)39 b(ar)m(e)h(only)h(inter)m(ested)g(in)g(a)
g(subset)h(of)f(that)g(information:)50 b(A)41 b(formatter)465
9835 y(is)54 b(pr)m(obably)f(not)g(inter)m(ested)f(in)i(comments,)g
(and)f(a)h(querying)f(tool)g(will)i(only)f(sear)m(ch)465
10034 y(the)64 b(document)g(instance)g(and)h(ignor)m(e)f(the)g(DTD.)120
b(Ther)m(efor)m(e)63 b(we)h(pr)m(ovide)h(a)g(set)f(of)465
10234 y(hooks)41 b(that)h(simply)g(r)m(eturn)e(the)h(application)g
(data)h(unchanged:)3288 11324 y(4)p eop
%%Page: 5 5
5 4 bop 1727 1063 a Fl(structure)42 b Fm(IgnoreHooks)59
b Fj(=)1941 1245 y Fl(struct)2156 1428 y(fun)42 b Fm(hookError\(a,)p
3262 1452 79 6 v 76 w(\))60 b Fj(=)18 b Fm(a)2156 1611
y Fl(fun)42 b Fm(hookW)-6 b(ar)t(ning\(a,)p 3483 1635
V 77 w(\))60 b Fj(=)18 b Fm(a)2156 1793 y Fl(fun)42 b
Fm(hookStar)6 b(tT)-18 b(ag\(a,)p 3491 1817 V 76 w(\))60
b Fj(=)18 b Fm(a)2156 1976 y(...)2156 2159 y Fl(fun)42
b Fm(hookXml\(a,)p 3186 2183 V 78 w(\))59 b Fj(=)19 b
Fm(a)2156 2341 y Fl(fun)42 b Fm(hookFinish)g(a)60 b Fj(=)18
b Fm(a)1941 2524 y Fl(end)1312 2835 y Fp(These)49 b(functions)i(ar)m(e)
e(polymorphic:)68 b(They)49 b(do)i(not)f(depend)g(on)g(the)g(type)g(of)
g(the)g(ap-)1312 3035 y(plication)h(data)h(and)g(can)e(thus)i(be)f
(used)h(with)g(arbitrary)f(types.)81 b(The)50 b(only)h(exception)1312
3234 y(is)60 b Fm(hookFinish)g Fp(which)g(r)m(equir)m(es)f(types)h
Fm(AppData)f Fp(and)h Fm(AppFinal)g Fp(to)g(be)f(equal.)106
b(An)59 b(ap-)1312 3433 y(plication)46 b(must)h(now)g(only)g(de\002ne)f
(the)g(hooks)g(that)h(have)f(a)h(dif)m(fer)m(ent)f(behavior)-12
b(.)65 b(E.g.,)1312 3632 y(the)39 b(hooks)h(for)f(a)h(validator)g(ar)m
(e)f(implemented)g(in)h(a)g(few)g(lines,)g(because)f(it)i(only)e
(prints)1312 3832 y(err)m(ors)h(and)h(warnings)h(but)g(ignor)m(es)f
(all)h(other)e(events:)1727 4127 y Fl(structure)i Fm(Chec)m(kHooks)59
b Fj(=)1941 4309 y Fl(struct)2156 4492 y(open)42 b Fm(T)-18
b(e)l(xtIO)41 b(Errors)f(IgnoreHooks)2156 4753 y Fl(type)i
Fm(AppData)59 b Fj(=)18 b Fm(OS)m(.Process)n(.status)2156
5014 y Fl(fun)42 b Fm(message\(pos,msg\))59 b Fj(=)18
b Fm(output\(stdErr,P)-7 b(osition2Str)r(ing)38 b(pos)6105
4959 y Fc(^)6175 5014 y Fm(\224:)51 b(\224)6386 4959
y Fc(^)6455 5014 y Fm(msg\))2156 5274 y Fl(fun)42 b Fm(hookError)e(\()p
3177 5298 V 78 w(,\(pos,err\)\))58 b Fj(=)2370 5457 y
Fm(OS)m(.Process)n(.f)l(ailure)39 b(bef)l(ore)i
(message\(pos,errorMessage)f(err\))2156 5640 y Fl(fun)i
Fm(hookW)-6 b(ar)t(ning)41 b(\(status,\(pos,w)n(ar)t(n\)\))57
b Fj(=)2370 5822 y Fm(status)41 b(bef)l(ore)f(message\(pos,w)n(ar)t
(ningMessage)h(w)n(ar)t(n\))1941 6005 y Fl(end)1312 6316
y Fp(Except)51 b(for)g Fm(hookError)g Fp(and)g Fm(hookW)-6
b(ar)t(ning)q Fp(,)53 b(all)g(hooks)e(ar)m(e)g(taken)g(over)f(fr)m(om)h
(str)o(uctur)m(e)1312 6516 y Fm(IgnoreHooks)o Fp(.)g(Another)39
b(example)g(is)j(the)e(application)h(alr)m(eady)g(mentioned)f(on)g
(page)h(4:)1312 6715 y(It)53 b(collects)g(all)g(attributes)g(named)f
Fe(href)p Fp(.)85 b(For)52 b(this)h(purpose)f(we)h(de\002ned)g(a)g(str)
o(uctur)m(e)1312 6914 y Fm(HrefDtd)o Fp(,)34 b(har)m(d-coding)g(this)g
(attribute)f(name)g(to)g(a)h(constant)e(index)i Fm(hrefIdx)n
Fp(.)49 b(This)33 b(is)i(used)1312 7113 y(in)41 b(the)g(de\002nition)h
(of)f(the)g(hooks:)1727 7408 y Fl(structure)h Fm(HrefHooks)59
b Fj(=)1941 7591 y Fl(struct)2156 7774 y(open)42 b Fm(Base)f(HrefDtd)g
(IgnoreHooks)2156 8035 y Fl(type)h Fm(AppData)59 b Fj(=)h
Fm(UniChar)-7 b(.V)-12 b(ector)39 b(list)2156 8217 y
Fl(type)j Fm(AppFinal)60 b Fj(=)g Fm(AppData)2156 8478
y Fl(fun)42 b Fm(\002ndHref)e(nil)61 b Fj(=)f Fm(NONE)2310
8661 y Fi(j)77 b Fm(\002ndHref)40 b(\(\(idx,attPres\))17
b(::)g(rest\))55 b Fj(=)2585 8843 y Fl(if)41 b Fm(idx)19
b Fa(<)-22 b(>)18 b Fm(hrefIdx)40 b Fl(then)i Fm(\002ndHref)f(rest)2585
9026 y Fl(else)g(case)h Fm(attPres)3092 9209 y Fl(of)58
b Fm(AP)p 3500 9209 45 7 v 53 w(PRESENT\(v)l(ec,)p 4572
9233 79 6 v 76 w(\))i Fi(\))g Fm(SOME)41 b(v)l(ec)3172
9391 y Fi(j)76 b Fm(AP)p 3500 9391 45 7 v 53 w(DEF)-12
b(A)-7 b(UL)-16 b(T\(v)l(ec,)p 4511 9415 79 6 v 76 w(\))60
b Fi(\))g Fm(SOME)41 b(v)l(ec)3172 9574 y Fi(j)p 3291
9598 V 214 w(\))60 b Fm(\002ndHref)40 b(rest)2156 9835
y Fl(fun)i Fm(hookStar)6 b(tT)-18 b(ag)40 b(\(a,\()p
3581 9859 V 78 w(,)p 3701 9859 V 77 w(,attSpecs,)p 4445
9859 V 76 w(,)p 4563 9859 V 78 w(\)\))59 b Fj(=)2370
10017 y Fl(case)42 b Fm(\002ndHref)f(attSpecs)2545 10200
y Fl(of)58 b Fm(NONE)i Fi(\))f Fm(a)2625 10383 y Fi(j)76
b Fm(SOME)42 b(x)60 b Fi(\))f Fm(x)17 b(::)g(a)2156 10643
y Fl(v)m(al)41 b Fm(hookFinish)61 b Fj(=)e Fm(re)l(v)1941
10826 y Fl(end)4134 11324 y Fp(5)p eop
%%Page: 6 6
6 5 bop 465 1063 a Fp(In)60 b(or)m(der)f(to)h(identify)h(a)g
Fe(href)e Fp(attribute,)64 b(function)c Fm(\002ndHref)g
Fp(need)f(only)h(compar)m(e)f(its)465 1262 y(index)g(with)h
Fm(hrefIdx)n Fp(.)105 b(Note)58 b(that)h(due)h(to)f(the)f(accumulative)
h(natur)m(e)f(of)h(the)g Fm(AppData)465 1461 y Fp(ar)m(gument,)54
b(the)f(attribute)g(values)g(ar)m(e)f(collected)h(in)g(r)m(everse)e(or)
m(der)-12 b(.)84 b(Ther)m(efor)m(e)50 b(func-)465 1660
y(tion)43 b Fm(hookFinish)h Fp(is)g(de\002ned)f(to)h(be)e(the)h(list)i
(r)m(eversing)d(function)h(and)g(r)m(eestablishes)g(the)465
1860 y(original)f(or)m(der)-12 b(.)465 2431 y Fg(3)239
b(Implementing)57 b(a)i(T)-27 b(ree-Based)59 b(Interface)465
2809 y Fp(The)51 b(hooks)h(interface)f(of)h Fo(fxp)g
Fp(its)h(event-based;)j(nevertheless)50 b(a)i(tr)m(ee-based)g
(interface)465 3009 y(can)e(easily)h(be)f(implemented)f(on)h(top)g(of)g
(the)g(hooks.)77 b(W)-15 b(e)50 b(pr)m(esent)f(bellow)h(an)h(imple-)465
3208 y(mentation)57 b(of)h(such)g(an)g(interface.)100
b(For)58 b(br)m(evity)-18 b(,)61 b(it)e(has)f(only)g(a)g(r)m(estricted)
g(informa-)465 3407 y(tion)46 b(set:)60 b(It)46 b(ignor)m(es)g(the)g
(DTD,)e(comments,)h(pr)m(ocessing)h(instr)o(uctions)g(and)g(the)f
(entity)465 3607 y(str)o(uctur)m(e)50 b(of)h(the)f(document.)79
b(It)51 b(is,)j(however)-12 b(,)51 b(easy)g(to)g(extend)f(the)g
(implementation)465 3806 y(to)41 b(supply)h(all)h(this)f(information.)
714 4005 y(The)51 b Fm(T)-18 b(ree)53 b Fp(data)g(type)g(is)g(simple:)
73 b(A)52 b(tr)m(ee)g(is)h(either)e(a)i(piece)e(of)h(text)g(or)g(an)g
(element)465 4204 y(consisting)66 b(of)f(a)g(start-tag)h(and)f(a)g
(list)h(of)f(tr)m(ees)f(as)i(content.)120 b(The)64 b(application)h
(data)465 4404 y(r)m(epr)m(esents)46 b(the)i(partial)g(document)f(tr)m
(ee)g(constr)o(ucted)g(so)i(far)-12 b(.)70 b(It)49 b(contains)e(in)i
(its)g Fm(stac)m(k)465 4603 y Fp(component)54 b(for)i(each)f(ancestor)g
(element)g(of)h(the)g(curr)m(ent)e(position,)60 b(its)d(start-tag)g
(to-)465 4802 y(gether)45 b(with)h(the)g(list)h(of)f(its)h(\226)f(alr)m
(eady)g(complete)e(\226)i(left)h(siblings;)i(component)43
b Fm(content)465 5001 y Fp(holds)48 b(the)f(childr)m(en)g(of)h(the)f
(curr)m(ent)f(element)g(that)i(ar)m(e)f(known)g(so)h(far)-12
b(.)69 b(At)48 b(the)g(begin-)465 5201 y(ning)g(of)h(the)f(parse)g
(both)f(components)g(ar)m(e)h(empty)-18 b(.)71 b(After)48
b(the)g(whole)g(document)f(has)465 5400 y(been)33 b(parsed,)j(the)e
(stack)h(must)g(be)g(empty)f(and)h(a)g(single)g(element)e(tr)m(ee)h
(must)h(have)f(been)465 5599 y(constr)o(ucted.)66 b(In)47
b(this)g(case)g(function)f Fm(hookFinish)h Fp(r)m(eturns)f(that)h
(element;)h(otherwise)e(it)465 5798 y(raises)c(an)f(exception.)714
5998 y(The)50 b(thr)m(ee)f(functions)i Fm(hookData)o
Fp(,)i Fm(hookCData)d Fp(and)h Fm(hookCharRef)f Fp(add)i(the)e(piece)f
(of)465 6197 y(text)60 b(r)m(eported)g(to)g(them)g(to)h(the)f(content)g
(of)h(the)f(curr)m(ent)f(element.)108 b(The)60 b(hook)g(for)g(a)465
6396 y(start-tag)45 b(pushes)f(that)h(tag)f(together)f(with)i(the)f
(content)e(of)j(the)e(curr)m(ent)g(element)f(onto)465
6595 y(the)52 b(stack.)85 b(The)52 b(element)f(started)i(by)f(that)h
(tag)g(now)g(becomes)e(the)h(curr)m(ent)f(element.)465
6795 y(Function)62 b Fm(hookEndT)-18 b(ag)63 b Fp(r)m(everses)e(the)g
(content)g(of)i(the)e(curr)m(ent)g(element)g(in)h(or)m(der)g(to)465
6994 y(compensate)35 b(for)i(the)f(r)m(eversing)g(ef)m(fect)h(of)g
(accumulation.)49 b(Its)37 b(tag)h(is)g(popped)e(fr)m(om)g(the)465
7193 y(stack)51 b(and)h(combined)d(with)j(its)g(content.)77
b(The)50 b(constr)o(ucted)g(tr)m(ee)g(is)h(then)f(pr)m(epended)465
7392 y(to)41 b(the)g(content)f(of)h(the)g(par)m(ent)f(element)g(which)i
(now)f(becomes)f(the)g(curr)m(ent)g(element.)465 7964
y Fg(4)239 b(Other)59 b(examples)465 8342 y Fo(fxp)52
b Fp(comes)e(with)i(a)g(few)g(application)f(examples)g(which)g(r)m
(esides)h(in)f(the)g Fe(src/Apps)e Fp(di-)465 8541 y(r)m(ectory)-18
b(.)48 b(The)36 b(inter)m(ested)h(r)m(eader)g(can)g(\002nd)h(ther)m(e)e
(further)g(examples)h(of)g(using)i(the)e Fo(fxp)p Fp('s)465
8741 y(pr)m(ogramming)j(interface.)465 9312 y Fg(References)548
9690 y Fp([1])84 b(John)57 b(Cowan)g(and)h(David)g(Megginson,)k
(editors.)c(XML)g(Information)e(Set.W3C)825 9890 y(W)-15
b(orking)73 b(Draft,)82 b(W)-15 b(orld)74 b(W)-9 b(ide)74
b(W)-15 b(eb)73 b(Consortium,)81 b(May)74 b(1999.)g(A)-15
b(vailable)74 b(at)825 10089 y(http://www)-15 b(.w3.or)m
(g/TR/1998/WD-xml-infoset-19990517)3288 11324 y(6)p eop
%%Page: 7 7
7 6 bop 1312 1396 5729 7 v 1312 10036 7 8641 v 1445 1657
a Fl(structure)42 b Fm(T)-18 b(reeData)60 b Fj(=)1659
1839 y Fl(struct)1874 2022 y(e)n(xception)41 b Fm(IllF)l(or)t(med)1874
2283 y Fl(type)g Fm(T)-18 b(ag)61 b Fj(=)f Fm(int)g Fi(\003)f
Fm(HookData.AttSpecList)1874 2465 y Fl(datatype)42 b
Fm(T)-18 b(ree)60 b Fj(=)g Fm(TEXT)41 b Fl(of)h Fm(UniChar)-7
b(.V)-12 b(ector)2940 2648 y Fi(j)77 b Fm(ELEM)41 b Fl(of)h
Fm(T)-18 b(ag)60 b Fi(\003)g Fm(Content)1874 2831 y Fl(withtype)41
b Fm(Content)60 b Fj(=)f Fm(T)-18 b(ree)42 b(list)1659
3013 y Fl(end)1445 3457 y(structure)g Fm(T)-18 b(reeHooks)60
b Fj(=)1659 3639 y Fl(struct)1874 3822 y(open)42 b Fm(IgnoreHooks)f(T)
-18 b(reeData)41 b(UniChar)1874 4083 y Fl(type)g Fm(AppData)60
b Fj(=)g Fm(Content)f Fi(\003)h Fm(\(T)-18 b(ag)60 b
Fi(\003)g Fm(Content\))40 b(list)1874 4265 y Fl(type)h
Fm(AppFinal)61 b Fj(=)f Fm(T)-18 b(ree)1874 4526 y Fl(v)m(al)41
b Fm(appStar)6 b(t)59 b Fj(=)g Fm(\(nil,nil\))1874 4787
y Fl(fun)41 b Fm(hookStar)6 b(tT)-18 b(ag)41 b(\(\(content,stac)m(k\),)
d(\()p 4234 4811 79 6 v 78 w(,elem,atts,)p 5003 4811
V 76 w(,empty\)\))60 b Fj(=)2088 4970 y Fl(if)41 b Fm(empty)g
Fl(then)h Fm(\(ELEM)g(\(\(elem,atts\),nil\))17 b(::)g(content,stac)m
(k\))2088 5152 y Fl(else)41 b Fm(\(nil,\(\(elem,atts\),content\))17
b(::)g(stac)m(k\))1874 5413 y Fl(fun)41 b Fm(hookEndT)-18
b(ag)42 b(\(\()p 3118 5437 V 78 w(,nil\),)p 3479 5437
V 77 w(\))60 b Fj(=)g Fl(raise)42 b Fm(IllF)l(or)t(med)2028
5596 y Fi(j)76 b Fm(hookEndT)-18 b(ag)42 b
(\(\(content,\(tag,content'\))17 b(::)g(stac)m(k\),)p
5082 5620 V 71 w(\))60 b Fj(=)2088 5778 y Fm(\(ELEM)41
b(\(tag,re)l(v)f(content\))17 b(::)g(content',stac)m(k\))1874
6039 y Fl(fun)41 b Fm(hookData)h(\(\(content,stac)m(k\),\()p
3951 6063 V 74 w(,v)l(ec,)p 4338 6063 V 77 w(\)\))60
b Fj(=)2147 6222 y Fm(\(TEXT)42 b(v)l(ec)17 b(::)g(content,stac)m(k\))
1874 6405 y Fl(fun)41 b Fm(hookCData)g(\(\(content,stac)m(k\),\()p
4058 6429 V 75 w(,v)l(ec\)\))59 b Fj(=)2147 6587 y Fm(\(TEXT)42
b(v)l(ec)17 b(::)g(content,stac)m(k\))1874 6770 y Fl(fun)41
b Fm(hookCharRef)g(\(\(content,stac)m(k\),\()p 4191 6794
V 75 w(,c,)p 4425 6794 V 77 w(\)\))59 b Fj(=)2147 6953
y Fm(\(TEXT\(Data2V)-12 b(ector)40 b([c]\))17 b(::)g(content,stac)m
(k\))1874 7213 y Fl(fun)41 b Fm(hookFinish)i(\([elem],nil\))59
b Fj(=)h Fm(elem)2028 7396 y Fi(j)76 b Fm(hookFinish)p
2912 7420 V 181 w Fj(=)59 b Fl(raise)42 b Fm(IllF)l(or)t(med)1659
7579 y Fl(end)1445 8022 y(structure)g Fm(P)-6 b(arseT)-18
b(ree)41 b(:)1659 8205 y Fl(sig)1874 8387 y(v)m(al)g
Fm(parseT)-18 b(ree)41 b(:)51 b(Ur)r(i.Ur)r(i)42 b(option)60
b Fi(!)f Fm(Dtd.Dtd)40 b(option)61 b Fi(!)e Fm(T)-18
b(reeData.T)g(ree)1659 8570 y Fl(end)1462 8753 y Fj(=)76
b Fl(struct)1874 8935 y(structure)42 b Fm(P)-6 b(arser)59
b Fj(=)h Fm(P)-6 b(arse)41 b(\()g Fl(structure)h Fm(Dtd)363
b Fj(=)60 b Fm(Dtd)3755 9118 y Fl(structure)42 b Fm(Hooks)172
b Fj(=)60 b Fm(T)-18 b(reeHooks)3755 9301 y Fl(structure)42
b Fm(P)-6 b(arserOptions)59 b Fj(=)h Fm(P)-6 b(arserOptions)41
b(\(\))3755 9483 y Fl(structure)h Fm(Resolv)l(e)60 b
Fj(=)g Fm(Resolv)l(eNull\))1874 9666 y Fl(fun)41 b Fm(parseT)-18
b(ree)42 b(ur)r(i)g(dtd)60 b Fj(=)f Fm(P)-6 b(arser)f(.parseDocument)40
b(ur)r(i)i(dtd)f(T)-18 b(reeHooks)n(.appStar)6 b(t)1659
9849 y Fl(end)p 7034 10036 7 8641 v 1312 10043 5729 7
v 2119 10247 a Fh(Figure)43 b(3:)e Fp(A)g(simple)h(tr)m(ee-based)f
(interface)f(on)h(top)g(of)g(hooks.)p 1312 10333 V 4134
11324 a(7)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
